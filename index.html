<!DOCTYPE html>
<html>
<head>
  <title>Daily Do Good Typing Test</title>
  <style>
    body {
      background: #fff3e0;
      font-family: 'Courier New', monospace;
      margin: 0; padding: 0 20px 40px 20px;
      color: #d84315;
      display: flex; flex-direction: column; align-items: center;
    }
    .banner {
      width: 100%; height: 100px;
      background-color: #fff;
      background-image: url('https://i.postimg.cc/RCLVGDXR/Your-paragraph-text.jpg');
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;
      border-bottom: 4px solid #ffb300;
      box-shadow: 0 3px 8px rgba(255,152,0,0.3);
      margin-bottom: 30px;
    }
    #controls {
      width: 75%; margin-bottom: 20px;
      display: flex; justify-content: space-between; gap: 20px; flex-wrap: wrap;
    }
    select {
      font-size: 18px; padding: 5px 12px;
      border-radius: 10px; border: 2px solid #ffa726;
      background: #fffde7; color: #d84315;
      outline: none; cursor: pointer; user-select: none;
      flex-grow: 1; min-width: 150px;
    }
    #test-text {
      margin: 0 auto 6px auto; width: 60%;
      background: #ffe0b2; border-radius: 8px;
      padding: 15px 20px 12px 20px; font-size: 22px;
      line-height: 1.4; color: #ff6f00; white-space: pre-wrap;
      border: 2px solid #ffa726; min-height: 130px;
      user-select: none; font-family: 'Courier New', monospace;
      display: none;
    }
    #test-text .correct { color: #33691e; }
    #test-text .incorrect { color: #b71c1c; }
    #test-text .current { border-left: 2px solid #ff9800; animation: blink 1s infinite; }
    @keyframes blink {
      0%,100% { border-color: #ff9800; }
      50% { border-color: transparent; }
    }
    #input-box {
      width: 75%; margin: 2px auto 16px auto;
      font-size: 22px; padding: 10px 15px;
      border-radius: 12px; border: 2px solid #ffa726;
      outline: none; color: #d84315; background: #fffde7;
      box-sizing: border-box; font-family: 'Courier New', monospace;
      display: none; min-height: 30px;
    }
    #stats {
      width: 75%; display: flex; justify-content: space-around;
      font-size: 20px; margin-bottom: 18px;
      color: #fb8c00; font-weight: bold; display: none;
    }
    #result {
      margin-bottom: 24px; font-size: 22px;
      font-weight: bold; color: #ff6f00;
      width: 75%; text-align: center; min-height: 35px;
    }
    button {
      font-size: 20px; background: #ffb300; color: #fff;
      border: none; border-radius: 10px; padding: 10px 40px;
      cursor: pointer; margin-bottom: 40px;
      transition: opacity 0.3s ease;
    }
    button:disabled {
      opacity: 0.5; cursor: not-allowed;
    }
    #history {
      width: 75%; background: #fff3e0; border: 2px solid #ffa726;
      border-radius: 15px; padding: 15px 25px; color: #d84315;
      font-size: 18px; max-height: 230px; overflow-y: auto;
      box-shadow: 0 2px 10px #ffcc80b8;
    }
    #history b {
      color: #ff6f00;
    }
  </style>
</head>
<body>
  <div class="banner"></div>
  <div id="controls">
    <select id="difficulty-select" title="Select Difficulty">
      <option value="" disabled selected>-- Select Difficulty --</option>
      <option value="easy">Easy</option>
      <option value="medium">Medium</option>
      <option value="hard">Hard</option>
    </select>
    <select id="duration-select" title="Select Duration">
      <option value="" disabled selected>-- Select Duration --</option>
      <option value="15">15 seconds</option>
      <option value="30">30 seconds</option>
      <option value="60">60 seconds</option>
    </select>
  </div>
  <div id="test-text"></div>
  <input type="text" id="input-box" placeholder="Start typing here..." disabled autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
  <div id="stats">
    <div>Time Left: <span id="time">0</span>s</div>
    <div>WPM: <span id="wpm">0</span></div>
    <div>Accuracy: <span id="accuracy">100</span>%</div>
  </div>
  <div id="result"></div>
  <button id="start-btn" disabled>Start Test</button>
  <div id="history"><b>Test History (Last 10):</b><br />No tests taken yet.</div>
<script>
  const difficultySelect = document.getElementById("difficulty-select");
  const durationSelect = document.getElementById("duration-select");
  const testTextEl = document.getElementById("test-text");
  const inputBox = document.getElementById("input-box");
  const timeEl = document.getElementById("time");
  const wpmEl = document.getElementById("wpm");
  const accuracyEl = document.getElementById("accuracy");
  const resultEl = document.getElementById("result");
  const startBtn = document.getElementById("start-btn");
  const historyEl = document.getElementById("history");
  const statsEl = document.getElementById("stats");

  const texts = {
    easy: [
      `the be to of and a in that have I it for not on with he as you do at this is my cat dog fish bird tree flower grass sun moon star light night day rain wind cold warm hot run jump walk talk sit stand look see hear listen read write learn play and up down left right fast slow big small red blue green yellow white black happy sad good ...`
    ],
    medium: [
      `beneath silver forest subtle journey castle velvet crystal quiet amber vivid narrow sudden fragile clever breeze silent river valley mountain path ancient wisdom brave heart gentle soul twilight glowing ember flickering shadow dancing flame whispered secrets hidden dreams forgotten tales ocean waves crashing against rugged cliffs salty breeze soothing mind endless horizon shining sky golden autumn leaves rustling underfoot cool breeze whispers change fleeting moments captured beauty golden meadow blooming flowers chirping birds peaceful sunlight warm breeze crystal clear lake reflection bright stars moonlight calm night whispers ...`
    ],
    hard: [
      `juxtapose zephyr labyrinth quixotic mnemonic zeitgeist ephemeral serendipity kaleidoscope chrysanthemum silhouette cryptic glyphs quirky quips fervent zeal eloquent prose enigmatic puzzles transcendental paradox metaphysical ephemeral kaleidoscopic chrysanthemum silhouette juxtaposition mnemonic labyrinthine quixotic serendipitous enigmatic transcendental polymath neologism syzygy verisimilitude obfuscate anachronism quixotic quintessential epiphany clandestine ethereal nomenclature perspicacity halcyon quintessence languid nebulous onomatopoeia soliloquy transcend verisimilitude obscure epiphany iridescent obfuscate nebulous ephemeral quintessential ...`
    ]
  };

  let timeLeft = 0;
  let timer = null;
  let isTestRunning = false;
  let currentIndex = 0;
  let mistakes = 0;
  let totalTyped = 0;
  let history = [];
  let userInput = "";
  let currentText = "";

  function getRandomText(difficulty) {
    const sets = texts[difficulty];
    const idx = Math.floor(Math.random() * sets.length);
    return sets[idx];
  }

  function renderTestText() {
    testTextEl.innerHTML = "";
    for (let i = 0; i < currentText.length; i++) {
      const span = document.createElement("span");
      span.innerText = currentText[i];
      if (i < currentIndex) {
        if (currentText[i] === userInput[i]) {
          span.classList.add("correct");
        } else {
          span.classList.add("incorrect");
        }
      }
      if (i === currentIndex) {
        span.classList.add("current");
      }
      testTextEl.appendChild(span);
    }
  }

  function updateStats() {
    let minutes = (parseInt(durationSelect.value) - timeLeft) / 60;
    minutes = minutes === 0 ? 1/60 : minutes;
    let wordsTyped = totalTyped / 5;
    let wpm = Math.round(wordsTyped / minutes);
    let accuracy = totalTyped === 0 ? 100 : Math.round(((totalTyped - mistakes) / totalTyped) * 100);
    wpmEl.textContent = wpm;
    accuracyEl.textContent = accuracy;
  }

  function enableStartIfReady() {
    if (difficultySelect.value !== "" && durationSelect.value !== "") {
      startBtn.disabled = false;
      startBtn.classList.add("enabled");
      testTextEl.style.display = "block";
      inputBox.style.display = "block";
      statsEl.style.display = "flex";
      inputBox.value = "";
    } else {
      startBtn.disabled = true;
      startBtn.classList.remove("enabled");
      testTextEl.style.display = "none";
      inputBox.style.display = "none";
      statsEl.style.display = "none";
      inputBox.value = "";
    }
  }

  difficultySelect.addEventListener("change", enableStartIfReady);
  durationSelect.addEventListener("change", enableStartIfReady);

  inputBox.addEventListener("input", (e) => {
    if (!isTestRunning) return;
    userInput = e.target.value;
    totalTyped = userInput.length;
    mistakes = 0;
    for (let i = 0; i < userInput.length; i++) {
      if (userInput[i] !== currentText[i]) mistakes++;
    }
    currentIndex = userInput.length;
    renderTestText();
    updateStats();

    if (userInput === currentText) {
      finishTest();
    }
  });

  startBtn.addEventListener("click", () => {
    currentText = getRandomText(difficultySelect.value);
    timeLeft = parseInt(durationSelect.value);
    timeEl.textContent = timeLeft;
    isTestRunning = true;
    currentIndex = 0;
    mistakes = 0;
    totalTyped = 0;
    userInput = "";
    inputBox.value = "";
    inputBox.disabled = false;
    inputBox.focus();
    resultEl.textContent = "";
    renderTestText();
    updateStats();
    clearInterval(timer);
    timer = setInterval(() => {
      timeLeft--;
      timeEl.textContent = timeLeft;
      if (timeLeft <= 0) {
        finishTest();
      }
    }, 1000);
  });

  function finishTest() {
    isTestRunning = false;
    clearInterval(timer);
    inputBox.disabled = true;

    let minutes = (parseInt(durationSelect.value) - timeLeft) / 60;
    minutes = minutes === 0 ? 1/60 : minutes;
    let wordsTyped = totalTyped / 5;
    let wpm = Math.round(wordsTyped / minutes);
    let accuracy = totalTyped === 0 ? 100 : Math.round(((totalTyped - mistakes) / totalTyped) * 100);

    let grade = "";
    if (wpm >= 50) grade = "A+";
    else if (wpm >= 40) grade = "A";
    else if (wpm >= 30) grade = "B";
    else if (wpm >= 20) grade = "C";
    else if (wpm >= 10) grade = "D";
    else grade = "F";

    resultEl.innerHTML = `<div>Test Completed! Your Grade: <b>${grade}</b></div>
                          <div>WPM: <b>${wpm}</b></div>
                          <div>Accuracy: <b>${accuracy}%</b></div>`;

    let date = new Date();
    let dt = `${date.getDate().toString().padStart(2,'0')}/${(date.getMonth()+1).toString().padStart(2,'0')}/${date.getFullYear()}, ${date.toLocaleTimeString()}`;
    history.unshift({ grade, wpm, accuracy, dt });
    if (history.length > 10) history.pop();
    updateHistory();
  }

  function updateHistory() {
    if (history.length === 0) {
      historyEl.innerHTML = "<b>Test History (Last 10):</b><br />No tests taken yet.";
      return;
    }
    let html = "<b>Test History (Last 10):</b><br />";
    history.forEach((test,i) => {
      html += `${i+1}. Grade: <b>${test.grade}</b>, WPM: <b>${test.wpm}</b>, Accuracy: <b>${test.accuracy}%</b>, Date: ${test.dt}<br />`;
    });
    historyEl.innerHTML = html;
  }

  enableStartIfReady();
</script>
</body>
</html>
