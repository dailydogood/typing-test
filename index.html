<!DOCTYPE html>
<html>
<head>
  <title>Daily Do Good Typing Test</title>
  <style>
    body {
      background: #fff3e0; /* light orange shade */
      font-family: 'Courier New', Courier, monospace;
      margin: 0; padding: 0 20px 40px 20px;
      color: #d84315;
      display: flex; flex-direction: column; align-items: center;
    }
    /* Banner */
    .banner {
      width: 100%;
      height: 140px;
      background-color: #fff;
      background-image: url('https://i.postimg.cc/RCLVGDXR/Your-paragraph-text.jpg');
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
      border-bottom: 4px solid #ffb300;
      box-shadow: 0 3px 8px rgba(255, 152, 0, 0.3);
      margin-bottom: 30px;
    }

    h1 {
      display: none; /* because banner has text/image */
    }

    #test-text {
      margin: 0 auto 25px auto;
      width: 75%;
      background: #ffe0b2;
      border-radius: 15px;
      padding: 20px 30px;
      font-size: 24px;
      line-height: 1.6;
      color: #ff6f00;
      white-space: pre-wrap;
      border: 2px solid #ffa726;
      min-height: 160px;
      user-select: none;
    }
    #test-text .correct { color: #33691e; }
    #test-text .incorrect { color: #b71c1c; }
    #test-text .current { border-left: 2px solid #ff9800; animation: blink 1s infinite; }
    @keyframes blink {
      0%, 100% { border-color: #ff9800; }
      50% { border-color: transparent; }
    }

    #input-box {
      width: 75%;
      margin: 15px auto 25px auto;
      font-size: 22px;
      padding: 12px 15px;
      border-radius: 12px;
      border: 2px solid #ffa726;
      outline: none;
      color: #d84315;
      background: #fffde7;
      box-sizing: border-box;
      font-family: 'Courier New', Courier, monospace;
    }

    #stats {
      width: 75%;
      display: flex;
      justify-content: space-around;
      font-size: 20px;
      margin-bottom: 30px;
      color: #fb8c00;
      font-weight: bold;
    }

    #result {
      margin-bottom: 30px;
      font-size: 22px;
      font-weight: bold;
      color: #ff6f00;
      width: 75%;
      text-align: center;
    }

    button {
      font-size: 20px;
      background: #ffb300;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 10px 40px;
      cursor: pointer;
      margin-bottom: 40px;
    }

    button:hover { background: #ff9800; }

    /* Test history */
    #history {
      width: 75%;
      background: #fff3e0;
      border: 2px solid #ffa726;
      border-radius: 15px;
      padding: 15px 25px;
      color: #d84315;
      font-size: 18px;
      max-height: 230px;
      overflow-y: auto;
      box-shadow: 0 2px 10px #ffcc80b8;
    }
    #history b {
      color: #ff6f00;
    }
  </style>
</head>
<body>
  <div class="banner"></div>

  <div id="test-text"></div>
  <input type="text" id="input-box" placeholder="Start typing here..." disabled autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
  <div id="stats">
    <div>Time: <span id="time">60</span>s</div>
    <div>WPM: <span id="wpm">0</span></div>
    <div>Accuracy: <span id="accuracy">100</span>%</div>
  </div>
  <div id="result"></div>
  <button id="start-btn">Start Test</button>

  <div id="history"><b>Test History (Last 10):</b><br />No tests taken yet.</div>

  <script>
    const testTextEl = document.getElementById('test-text');
    const inputBox = document.getElementById('input-box');
    const timeEl = document.getElementById('time');
    const wpmEl = document.getElementById('wpm');
    const accuracyEl = document.getElementById('accuracy');
    const resultEl = document.getElementById('result');
    const startBtn = document.getElementById('start-btn');
    const historyEl = document.getElementById('history');

    const testText = `Father to son, father to child,
A silence surrounds their words,
The story lingers, never mild.
Long is the path, and slow the miles.
Dreams light up the deepest night.
Mountains high, rivers wide.
Their love is calm, their fears are bright.
With open hearts, they confide.`;

    let timeLeft = 60;
    let timer = null;
    let isTestRunning = false;
    let currentIndex = 0;
    let mistakes = 0;
    let totalTyped = 0;
    let history = [];

    function renderTestText() {
      testTextEl.innerHTML = '';
      for (let i = 0; i < testText.length; i++) {
        const span = document.createElement('span');
        span.innerText = testText[i];
        if (i < currentIndex) {
          if (testText[i] === userInput[i]) {
            span.classList.add('correct');
          } else {
            span.classList.add('incorrect');
          }
        }
        if (i === currentIndex) {
          span.classList.add('current');
        }
        testTextEl.appendChild(span);
      }
    }

    let userInput = '';

    function updateStats() {
      let minutes = (60 - timeLeft) / 60;
      minutes = minutes === 0 ? 1/60 : minutes; // avoid divide by zero
      let wordsTyped = totalTyped / 5;
      let wpm = Math.round(wordsTyped / minutes);
      let accuracy = totalTyped === 0 ? 100 : Math.round(((totalTyped - mistakes) / totalTyped) * 100);
      wpmEl.textContent = wpm;
      accuracyEl.textContent = accuracy;
    }

    inputBox.addEventListener('input', e => {
      if (!isTestRunning) return;

      userInput = e.target.value;
      totalTyped = userInput.length;
      mistakes = 0;
      for (let i = 0; i < userInput.length; i++) {
        if (userInput[i] !== testText[i]) mistakes++;
      }
      currentIndex = userInput.length;
      renderTestText();
      updateStats();

      if (userInput === testText) {
        finishTest();
      }
    });

    function startTest() {
      isTestRunning = true;
      currentIndex = 0;
      mistakes = 0;
      totalTyped = 0;
      userInput = '';
      timeLeft = 60;
      inputBox.value = '';
      inputBox.disabled = false;
      inputBox.focus();
      resultEl.textContent = '';
      renderTestText();
      updateStats();
      clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        timeEl.textContent = timeLeft;
        if (timeLeft <= 0) {
          finishTest();
        }
      }, 1000);
    }

    function finishTest() {
      isTestRunning = false;
      clearInterval(timer);
      inputBox.disabled = true;

      let minutes = (60 - timeLeft) / 60;
      minutes = minutes === 0 ? 1/60 : minutes;
      let wordsTyped = totalTyped / 5;
      let wpm = Math.round(wordsTyped / minutes);
      let accuracy = totalTyped === 0 ? 100 : Math.round(((totalTyped - mistakes) / totalTyped) * 100);

      let grade = "";
      if (wpm >= 50) grade = "A+";
      else if (wpm >= 40) grade = "A";
      else if (wpm >= 30) grade = "B";
      else if (wpm >= 20) grade = "C";
      else if (wpm >= 10) grade = "D";
      else grade = "F";

      resultEl.innerHTML = `<div>Test Completed! Your Grade: <b>${grade}</b></div>
                            <div>WPM: <b>${wpm}</b></div>
                            <div>Accuracy: <b>${accuracy}%</b></div>`;

      // Add this test to history
      let date = new Date();
      let dt = `${date.getDate().toString().padStart(2,'0')}/${(date.getMonth()+1).toString().padStart(2,'0')}/${date.getFullYear()}, ${date.toLocaleTimeString()}`;
      history.unshift({grade, wpm, accuracy, dt});
      if(history.length > 10) history.pop();
      updateHistory();
    }

    function updateHistory() {
      if(history.length === 0) {
        historyEl.innerHTML = "<b>Test History (Last 10):</b><br />No tests taken yet.";
        return;
      }
      let html = "<b>Test History (Last 10):</b><br />";
      history.forEach((test,i) => {
        html += `${i+1}. Grade: <b>${test.grade}</b>, WPM: <b>${test.wpm}</b>, Accuracy: <b>${test.accuracy}%</b>, Date: ${test.dt}<br />`;
      });
      historyEl.innerHTML = html;
    }

    startBtn.addEventListener('click', startTest);

    // Initial render
    renderTestText();
    updateHistory();
  </script>
</body>
</html>
